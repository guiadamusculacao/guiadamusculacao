<h4>Postagens Relacionadas</h4> 
<div class="home" style="text-align:center;">
<div id="grid" class="row flex-grid">
{% assign maxRelated = 4 %}
{% assign minCommonTags =  2 %}
{% assign maxRelatedCounter = 0 %}

  {% for post in site.posts %}

    {% assign sameTagCount = 0 %}
    {% assign commonTags = '' %}

    {% for tag in post.tags %}
      {% if post.url != page.url %}
        {% if page.tags contains tag %}
          {% assign sameTagCount = sameTagCount | plus: 1 %}
          {% capture tagmarkup %} <span class="label label-default">{{ tag }}</span> {% endcapture %}
          {% assign commonTags = commonTags | append: tagmarkup %}
        {% endif %}
      {% endif %}
    {% endfor %}

    {% if sameTagCount >= minCommonTags %}
    <article class="corpo-post" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
        <div class="box-body">
        {% if post.image %}
        {% include new-post-tag.html date=post.date %}
            <a href="{{ post.url }}" {%if isnewpost %}class="novo-post"{% endif %}>
                <img src="https://i.imgur.com/z2qp1YM.png" data-url="{{ post.image }}" alt="{{ post.descricao }}" class="preload">
            </a>
            <p class="tempo-post"><script>
function secondsToHms(d){d=Number(d);var h=Math.floor(d / 3600);var m=Math.floor(d % 3600 / 60);var s=Math.floor(d % 3600 % 60);return ('0' + h).slice(-2) + ":" + ('0' + m).slice(-2) + ":" + ('0' + s).slice(-2);}
document.write(secondsToHms({{ post.duracao }}));
</script>
            </p>
        {% endif %}
            <div class="box-info">
                <a class="link-post" href="{{ post.url | prepend: site.baseurl }}">
                    <h2 class="titulo" itemprop="name">{{ post.title }}</h2>
                </a>
                <div class="data-post">
                    <meta itemprop="datePublished" content="{{ post.date | date_to_xmlschema }}">
                    <time itemprop="datePublished" datetime="{{ post.date | date_to_xmlschema }}" class="date">
                        {% include date.html date=post.date %}
                    </time>
                </div>
            </div>
        </div>
    </article>
      {% assign maxRelatedCounter = maxRelatedCounter | plus: 1 %}
      {% if maxRelatedCounter >= maxRelated %}
        {% break %}
      {% endif %}
    {% endif %}

  {% endfor %}

</div>	
</div> 
